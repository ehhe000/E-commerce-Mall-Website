<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>免费注册</title>
		<link rel="stylesheet" type="text/css" href="css/public.css" />
		<link rel="stylesheet" type="text/css" href="css/regist.css" />
	</head>
	<body>
		<!--头部区域-->
		<div class="zhead-info">
				<div class="zhead-info-box">
					<!--zhead左边区域-->
					<div class="arealeft">
						<a><i>送货到</i><em  class="area1">北京</em><b></b></a>
						<div class="areaSell">
	                		<ul>
	                			<li><a href="#">湖南</a></li>
	                			<li><a href="#">湖北</a></li> 
	                			<li><a href="#">河南</a></li> 
	                			<li><a href="#">江西</a></li> 
	                			<li><a href="#">四川</a></li>
	                			<li><a href="#">贵州</a></li> 
	                			<li><a href="#">云南</a></li> 
	                			<li><a href="#">重庆</a></li> 
	                			<li><a href="#">西藏</a></li> 
	                			<li><a href="#">广东</a></li> 
	                			<li><a href="#">广西</a></li> 
	                			<li><a href="#">海南</a></li> 
	                			<li><a href="#">北京</a></li> 
	                			<li><a href="#">河北</a></li> 
	                			<li><a href="#">内蒙古</a></li> 
	                			<li><a href="#">山西</a></li>
	                			<li><a href="#">天津</a></li>
	                			<li><a href="#">江苏</a></li>
	                			<li><a href="#">山东</a></li>
	                			<li><a href="#">上海</a></li>
	                			<li><a href="#">福建</a></li>
	                			<li><a href="#">浙江</a></li>
	                			<li><a href="#">安徽</a></li>
	                			<li><a href="#">辽宁</a></li>
	                			<li><a href="#">黑龙江</a></li>
	                			<li><a href="#">吉林</a></li>
	                			<li><a href="#">陕西</a></li>
	                			<li><a href="#">新疆</a></li>
	                			<li><a href="#">甘肃</a></li>
	                			<li><a href="#">宁夏</a></li>
	                			<li><a href="#">青海</a></li>
	                		</ul>
            			</div>
					</div>
					<!--zhead右边区域-->
					<div class="arearight">
						<div class="r1">
							<p>欢迎来到曾品，请</p>
							<!--登录链接-->
							<a class="login" href="login.html">登录</a>
							<i>&nbsp;|&nbsp;</i>
							<!--注册链接-->
							<a class="regist" href="regist.html">免费注册</a>
						</div>
						<div class="uinfo" style="display: none;width:230px;float: left;">欢迎您：</div>
						<a  class="uhshanchu" href="javascript:void(0);" style="display: none;">退出</a>
						<div class="r2">
							<!--我的订单-->
							<p><a href="dingdan.html">我的订单</a><b></b></p>
							<div>
								<a href="#">我的钱包</a>
								<a href="#">我的礼券</a>
							</div>
						</div>
						<div class="r3">
							<p><a href="#">快速导航</a></p>
						</div>
						<div class="r4">
							<p><a href="#">收藏曾品</a></p>
						</div>
						<div class="r5">
							<p><a href="#">手机曾品</a></p>
						</div>
		
					</div>
				</div>
		</div>
			
		<!--主内容区域-->
		<div class="login_bj">
			<!--logo区域-->
			<div class="logo">
				<h1><a href="index.html"><img src="imgs/logo_tm.png"/></a></h1>
			</div>
			<!--表单区域-->
			<form id="loginform">
				<div class="loginContent">
					<div class="loginTitle">
						<span class="ltl"></span>
						<span class="ltr"><a id="reg_link" href="">免费注册</a></span>
					</div>
					<ul class="loginInput">
						<li class="mailwrap">
							<h2>账号</h2>
							<input  type="text" id="loginName"/>
							<div class="registinfo1" style="display: none;">请输入账号</div>
							<div class="registinfo11" ></div>
						</li>
				
						<li class="pwwrap">
							<h2>密码</h2>
							<input type="password" id="passwd" />
							<div class="registinfo2" style="display: none;">请输入密码</div>
						</li>
						<li class="buttonwrap">
							<a href="javascript:void(0);" id="formSubmit">同意协议并注册</a>
							<div class="registinfo3"></div>
						</li>
						<li class="msgwrap"><a href="">《曾品网用户协议》</a></li>
					</ul>
				</div>
				
				
				
			</form>
		</div>
		
		
		
		
		<!--版权块-->			
		<div class="zfooter-cr">
			<div class="cr">
				<div class="ul">
					<li><a href="">关于曾品</a></li>
					<li><a href="">免责声明</a></li>
					<li><a href="">隐私声明</a></li>
					<li><a href="">版权声明</a></li>
					<li><a href="">招聘信息</a></li>
					<li><a href="">联系我们</a></li>
					<li><a href="">帮助中心</a></li>
					<li><a href="">友情链接</a></li>
				</div>
				<p>Copyright © 2008-2016 Lefeng.com All Rights Reserved. 天津曾品电子商务有限公司 津ICP备15005555号-1  京公网安备11010502014183 营业执照</p>
				<p>公司全称：天津曾品电子商务有限公司     公司固话：400 000 1818     公司地址：天津市武清区京津电子商务产业园宏瑞道18号</p>
				<div class="img">
					<a href=""></a>
					<a href=""></a>
					<a href=""></a>
					<a href=""></a>	
				</div>		
			</div>
		</div>
	
	
		<script type="text/javascript" src="js/js.js" ></script>		
		<script type="text/javascript" src="js/regist.js" ></script>		
		<script>
			
			var istrue1=false;
			var istrue2=false;
			var istrue3=false;
			$("#loginName").onfocus=function(){
				$(".registinfo1")[0].style.display="block";
			}
			$("#passwd").onfocus=function(){
				$(".registinfo2")[0].style.display="block";
			}
			
			//校验登录名：只能输入5-20个以字母开头、可带数字、“_”、“.”的字串
			$("#loginName").onkeyup=function(){
				var reg=/^[a-zA-Z]{1}([a-zA-Z0-9]|[._]){4,19}$/;   	
				var str=this.value;
				var array = reg.exec(str);
				
				if(array!==null){
					$(".registinfo1")[0].innerHTML="用户名合法";
					istrue1=true;
				}
				else{
					str=this.value;
					$(".registinfo1")[0].innerHTML="只能输入5-20个以字母开头、可带数字、“_”、“.”的字串";
					istrue1=false;
				}
			}
			
			//校验密码：只能输入6-20个字母、数字、下划线   
			$("#passwd").onkeyup=function(){
				var reg=/^(\w){6,20}$/;   	
				var str=this.value;
				var array = reg.exec(str);
				if(array!==null){
					$(".registinfo2")[0].innerHTML="密码合法";
					istrue2=true;
				}
				else{
					str=this.value;
					$(".registinfo2")[0].innerHTML="只能输入6-20个字母、数字、下划线 " ;
					istrue2=false;
				}
			}
			
			$("#loginName").onblur=function(){
				var _username=$("#loginName").value;
				ajax({
					url:"php/checkname.php",
					type:"post",
					dataType:"json",
					data:{
						username:_username,
					},
					success:function(data){
						if(data.status==1){		
							$(".registinfo11")[0].innerHTML="用户名已经被占用，请重新注册";	
						}
						else{
							if(istrue1==true){
								$(".registinfo11")[0].innerHTML="该用户名可用";	
							}
							else{
								$(".registinfo11")[0].innerHTML="该用户名不可用";	
							}						
						}
					},
					error:function(errorMsg){
						console.log(errorMsg);
					}
				});
			}
			
			/*点击注册按钮，如果用户名和密码都合法的话，通过ajax请求，
			将文本框里的用户名发送到checkname.php，这个文件链接数据库，
			调用mysql_query()函数执行sql语句,看数据库中是否存在匹配的数据,返回一个结果集,
			使用mysql_fetch_array() 函数以数组的形式返回这一行的信息,判断是否有这么一条信息,如果有,就将stauts设置成1*/
			$("#formSubmit").onclick=function(){ 
				if(istrue1===true&&istrue2===true){
					var _username=$("#loginName").value;
					ajax({
						url:"php/checkname.php",
						type:"post",
						dataType:"json",
						data:{
							username:_username,
						},
						success:function(data){
							if(data.status==1){
								$(".registinfo3")[0].innerHTML="用户名已经被占用，请重新注册";
								istrue3=false;
							}
							else{
								istrue3=true;
								$(".registinfo11")[0].innerHTML="该用户名可用";	
								_username=$("#loginName").value;
								_password=$("#passwd").value;
								if(istrue3==true){
									ajax({
										url:"php/regist.php",
										data:{
											username:_username,
											password:_password
										},
										type:"post",
										success:function(data){
											$(".registinfo3")[0].innerHTML="注册成功" ;
											location="login.html";	
										},
										error:function(errorMsg){
											console.log(errorMsg);
										}
									});			
								}
							}
						}
					});
				}	
				
				else{
					$(".registinfo3")[0].innerHTML="请输入正确的用户名和密码";
				}
				
			}
			
			
		</script>

	</body>
</html>
